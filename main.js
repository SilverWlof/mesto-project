(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{k:()=>S});var e=document.querySelectorAll(".popup"),o=document.querySelector("#popup-profile"),n=document.querySelector("#popup-place"),r=document.querySelector("#popup-zoom"),a=document.querySelector("#popup__updata-avatar"),c=(document.querySelector("#popup__delete-card"),document.forms.ProfileForm),i=(document.forms.CardForm,document.forms.avatarImage,document.querySelectorAll(".popup__button-save")),s=r.querySelector(".popup__zoom-in"),u=r.querySelector(".popup__zoom-description"),l=document.querySelector(".profile"),d=l.querySelector(".profile__name"),p=l.querySelector(".profile__description"),f=l.querySelector(".profile__avatar"),m=document.querySelector(".elements");function h(t,e,o){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.removeAttribute("disabled"),e.classList.remove(o.inactiveButton)):(e.setAttribute("disabled",!0),e.classList.add(o.inactiveButton))}function v(t){t.classList.add("popup_opened"),document.addEventListener("keydown",y)}function _(t){t.classList.remove("popup_opened"),document.removeEventListener("keydown",y)}function y(t){"Escape"===t.key&&_(document.querySelector(".popup_opened"))}function b(t){s.src=t.target.src,s.alt=t.target.alt,u.textContent=t.target.alt,v(r)}function g(t){var e=function(t){var e=document.querySelector("#element").content.querySelector(".element").cloneNode(!0),o=e.querySelector(".element__text"),n=e.querySelector(".element__image"),r=e.querySelector(".element__button-like"),a=e.querySelector(".element__button-delete"),c=e.querySelector(".element__counter-like");if(e.id=t._id,t.owner._id===S?(e.id=t._id,a.addEventListener("click",(function(t){var o;o=e.id,fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/cards/"+o,{method:"DELETE",headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})),t.target.closest(".element").remove()}))):(a.setAttribute("disabled",!0),a.classList.add("element__button-delete_disable")),o.textContent=t.name,n.alt=t.name,n.src=t.link,t.likes){c.textContent=t.likes.length;for(var i=0;i<t.likes.length;i++)t.likes[i]._id===S&&r.classList.add("element__button-like_liked")}else c.textContent="0";return n.addEventListener("click",b),e.addEventListener("click",(function(t){var e;t.target.classList.contains("element__button-like")&&(t.target.classList.contains("element__button-like_liked")?function(t){return fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/cards/likes/"+t.id,{method:"DELETE",headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}(t.target.closest(".element")).then((function(e){t.target.closest(".element").querySelector(".element__counter-like").textContent=e.likes.length})).then((function(){t.target.classList.toggle("element__button-like_liked")})).catch((function(t){console.log("ошибка - "+t)})):(e=t.target.closest(".element"),fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/cards/likes/"+e.id,{method:"PUT",headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(e){t.target.closest(".element").querySelector(".element__counter-like").textContent=e.likes.length})).then((function(){t.target.classList.toggle("element__button-like_liked")})).catch((function(t){console.log("ошибка - "+t)})))})),e}(t);m.prepend(e)}Array.from(document.querySelectorAll(".form")),e.forEach((function(t){t.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&_(t.target),t.target.classList.contains("popup__button-close")&&_(t.target.closest(".popup_opened"))}))})),function(t){Array.from(document.querySelectorAll("."+t.formList)).forEach((function(e){!function(t,e){var o=Array.from(t.querySelectorAll("."+e.inputList)),n=t.querySelector("."+e.ButtonSave);h(o,n,e),o.forEach((function(r){r.addEventListener("input",(function(){!function(t,e,o){e.validity.valid,e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMassage):e.validity.typeMismatch?e.setCustomValidity(e.dataset.errorMassageUrl):e.validity.tooShort?e.setCustomValidity(e.dataset.errorMassageShort):e.setCustomValidity(""),e.validity.valid?function(t,e,o){var n=e.querySelector(".".concat(t.id,"-")+o.inputError);t.classList.remove(o.errorClass),n.textContent="",n.classList.remove(o.errorClass)}(e,t,o):function(t,e,o,n){var r=e.querySelector(".".concat(t.id,"-")+n.inputError);t.classList.add(n.errorClass),r.classList.add(n.errorClass),r.textContent=o}(e,t,e.validationMessage,o)}(t,r,e),h(o,n,e)}))}))}(e,t)}))}({formList:"form",inputList:"popup__input",ButtonSave:"popup__button-save",inactiveButton:"popup__button-save_disable",inputError:"error",errorClass:"popup__warning_show"}),l.querySelector(".profile__edit-avatar").addEventListener("click",(function(t){v(a)})),l.querySelector(".profile__button-add-profile").addEventListener("click",(function(){v(n)})),l.querySelector(".profile__button-edit").addEventListener("click",(function(){v(o),c.name.value=d.textContent,c.description.value=p.textContent})),a.addEventListener("submit",(function(t){var e,o;t.preventDefault(),i.textContent="Сохранение...",(e=t,o=e.target.querySelector(".popup__button-save"),fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/users/me/avatar",{method:"PATCH",headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390","Content-Type":"application/json"},body:JSON.stringify({avatar:e.target.avatarImage.value})}).finally((function(){o.textContent="Сохранение..."})).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(t){f.src=t.avatar})).then((function(){_(a),t.target.reset()})).catch((function(t){console.log("ошибка - "+t)})).finally((function(){i.textContent="Сохранить"}))})),o.addEventListener("submit",(function(t){var e;t.preventDefault(),i.textContent="Сохранение...",(e=t,fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/users/me",{method:"PATCH",headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390","Content-Type":"application/json"},body:JSON.stringify({name:e.target.name.value,about:e.target.description.value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(t){d.textContent=t.name,p.textContent=t.about})).catch((function(t){console.log("ошибка - "+t)})).finally((function(){i.textContent="Сохранить"}))})),n.addEventListener("submit",(function(t){var e;t.preventDefault(),i.textContent="Сохранение...",(e=t,e.target.querySelector(".popup__button-save"),fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/cards",{method:"POST",headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390","Content-Type":"application/json"},body:JSON.stringify({name:e.target.querySelector("#placeName").value,link:e.target.querySelector("#placeImage").value})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(t){g(t)})).then((function(){var e;_(n),t.target.reset(),(e=formElement.querySelector("."+settings.ButtonSave)).setAttribute("disabled",!0),e.classList.add(inactiveButton)})).catch((function(t){console.log("ошибка - "+t)})).finally((function(){i.textContent="Сохранить"}))}));var S="123";fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/users/me",{headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){d.textContent=t.name,p.textContent=t.about,f.src=t.avatar,S=t._id})).then((function(){fetch("https://mesto.nomoreparties.co/v1/plus-cohort-23/cards",{headers:{authorization:"6ad1c47f-6af4-42c4-b56f-bacd15588390"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){t.reverse().forEach(g)}))})).catch((function(t){console.log("ошибка - "+t)}))})();